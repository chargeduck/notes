import{_ as s,o as a,c as i,R as n}from"./chunks/framework.3IDgao2s.js";const u=JSON.parse('{"title":"1. 下载安装","description":"","frontmatter":{},"headers":[],"relativePath":"backend/mq/kafka/centos_cluster.md","filePath":"backend/mq/kafka/centos_cluster.md"}'),e={name:"backend/mq/kafka/centos_cluster.md"},l=n(`<div class="info custom-block"><p class="custom-block-title">INFO</p><p>折腾了半上午在windows下使用kraft的方式搭建kafka集群，最终还是失败了。</p><p>直接该用vmware下的centos7</p><p>参考文档</p><ol><li><a href="https://blog.csdn.net/ql_7256/article/details/131530446" target="_blank" rel="noreferrer">centos离线安装kafka集群安装(Kraft模式)</a></li></ol></div><h1 id="_1-下载安装" tabindex="-1">1. 下载安装 <a class="header-anchor" href="#_1-下载安装" aria-label="Permalink to &quot;1. 下载安装&quot;">​</a></h1><ol><li><a href="https://downloads.apache.org/kafka/3.7.0/kafka_2.13-3.7.0.tgz" target="_blank" rel="noreferrer">下载地址</a></li><li>确保三台机器都安装好了jdk</li><li>上传到centos,用<code>xshell</code>和<code>xftp</code>更方便</li></ol><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 上传文件到第一台服务器</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">scp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kafka_2.13-3.7.0.tgz</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> root@192.168.242.130:/opt/software</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 解压缩</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tar</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -zxvf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kafka_2.13-3.7.0</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#同样的操作在131 132服务器上都执行一遍</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h1 id="_2-修改配置文件" tabindex="-1">2. 修改配置文件 <a class="header-anchor" href="#_2-修改配置文件" aria-label="Permalink to &quot;2. 修改配置文件&quot;">​</a></h1><ol><li>OS1</li></ol><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kafka_2.13-3.7.0/config/kraft</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">vim</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> server.properties</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-properties vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">properties</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">controller.quorum.voters</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=1@192.168.242.130:9093,2@192.168.242.131:9093,3@192.168.242.132:9093</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">listeners</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=PLAINTEXT://192.168.242.130:9092,CONTROLLER://192.168.242.130:9093</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">advertised.listeners</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=PLAINTEXT://192.168.242.130:9092</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">log.dirs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=/opt/software/kafka_2.13-3.7.0/data/log</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ol start="2"><li>OS2</li></ol><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">vim</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kafka_2.13-3.7.0/config/kraft/server.properties</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-properties vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">properties</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">node.id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=2</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">controller.quorum.voters</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=1@192.168.242.130:9093,2@192.168.242.131:9093,3@192.168.242.132:9093</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">listeners</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=PLAINTEXT://192.168.242.131:9092,CONTROLLER://192.168.242.131:9093</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">advertised.listeners</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=PLAINTEXT://192.168.242.131:9092</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">log.dirs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=/opt/software/kafka_2.13-3.7.0/data/log</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ol start="3"><li>OS3</li></ol><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">vim</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kafka_2.13-3.7.0/config/kraft/server.properties</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><div class="language-properties vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">properties</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">node.id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=3</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">controller.quorum.voters</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=1@192.168.242.130:9093,2@192.168.242.131:9093,3@192.168.242.132:9093</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">listeners</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=PLAINTEXT://192.168.242.132:9092,CONTROLLER://192.168.242.132:9093</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">advertised.listeners</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=PLAINTEXT://192.168.242.132:9092</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">log.dirs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=/opt/software/kafka_2.13-3.7.0/data/log</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h1 id="_3-配置集群id" tabindex="-1">3. 配置集群id <a class="header-anchor" href="#_3-配置集群id" aria-label="Permalink to &quot;3. 配置集群id&quot;">​</a></h1><ol><li>在os1下执行生成uuid的命令</li></ol><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /opt/software/kafka_2.13-3.7.0</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 生成集群id</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">./bin/kafka-storage.sh</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> random-uuid</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#记住这个id等一会需要使用</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Xlpamcu1SemGxstTUJF98g</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ol start="2"><li>在三台服务器下分别执行命令，注意这列的uuid需要换成自己的</li></ol><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">./bin/kafka-storage.sh</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> format</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -t</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Xlpamcu1SemGxstTUJF98g</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -c</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ./config/kraft/server.properties</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h1 id="_4-启动" tabindex="-1">4. 启动 <a class="header-anchor" href="#_4-启动" aria-label="Permalink to &quot;4. 启动&quot;">​</a></h1><ol><li>开放三台服务器的<code>9092</code>、 <code>9093</code>端口</li></ol><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 开放10911端口</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">firewall-cmd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --zone=public</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --add-port=9092/tcp</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --permanent</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">firewall-cmd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --zone=public</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --add-port=9093/tcp</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --permanent</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 查看有哪些端口开放</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">firewall-cmd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --zone=public</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --list-ports</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> firewalld</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ol start="2"><li>启动命令</li></ol><div class="language-shell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">nohup</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ./bin/kafka-server-start.sh</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ./config/kraft/server.properties</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nohup.log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ol start="3"><li>使用offsetExplorer.exe连接<code>192.168.242.130:9092</code>即可</li></ol><h1 id="_5-ui" tabindex="-1">5. UI <a class="header-anchor" href="#_5-ui" aria-label="Permalink to &quot;5. UI&quot;">​</a></h1><ol><li>使用<a href="./.html">offsetExplorer</a></li><li>使用<a href="https://github.com/provectus/kafka-ui/releases/download/v0.7.2/kafka-ui-api-v0.7.2.jar" target="_blank" rel="noreferrer">Kraft-UI</a></li></ol>`,27),p=[l];function t(r,h,k,d,o,c){return a(),i("div",null,p)}const b=s(e,[["render",t]]);export{u as __pageData,b as default};
